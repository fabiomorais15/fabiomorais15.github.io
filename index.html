<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Deep Link Example</title>
  </head>
  <body>
    <script>
      // The app's deep link URL scheme
      const appLink = "com.mycareforce://open";

      // Fallback URLs for the app store
      const androidStoreLink = "https://play.google.com/store/apps/details?id=com.mycareforce";
      const iosStoreLink = "https://apps.apple.com/pt/app/mycareforce/id6450905583"; // Replace with your app's App Store URL
      const macAppStoreLink = "https://apps.apple.com/pt/app/mycareforce/id6450905583"; // Use the macOS App Store URL if different

      // Detect the user's platform
      const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
      const isMacOS = /Macintosh/.test(navigator.userAgent) && navigator.maxTouchPoints === 0;

      const storeLink = isIOS
        ? iosStoreLink
        : isMacOS
        ? macAppStoreLink
        : androidStoreLink;

      const openApp = () => {
        const timeout = 500; // Timeout for detecting app launch
        const now = Date.now();

        // Redirect to the app store if the app is not opened
        const timer = setTimeout(() => {
          window.location.href = storeLink;
        }, timeout);

        // Try to open the app
        if (isIOS || isMacOS) {
          // Use a Universal Link or the deep link
          window.location.href = appLink;
        } else {
          // Android: Use an iframe to avoid visible navigation
          const iframe = document.createElement("iframe");
          iframe.src = appLink;
          iframe.style.display = "none";
          document.body.appendChild(iframe);
        }

        // Clear the timer if the app opens
        window.addEventListener("blur", () => clearTimeout(timer), { once: true });
      };

      // Run the detection script
      openApp();
    </script>
  </body>
</html>
